# R workflow 
Example workflow using R to take standard MaxN and Length+3D point queries from EventMeasure from www.seagis.com.au.

Six sequential scripts are provided:
0. Format habitat annotation data from BRUV <a href="https://github.com/TimLanglois/HabitatAnnotation">- see separate Habitat Annotation repository for details</a>
1. Format and check species names and min and max lengths against a master list.
2. Calculate biomass from lenght-weigth relationship and tidy data for analysis.
3. Combine data products for modeling and plotting
4. Format data for PRIMER
x1. Generic plotting

These R scripts are included in a published paper<sup>1</sup>, please cite if you use it.
Please refer to this GitHub repository for updated versions of the R script.

<HR>
</HR>

<b>Table of contents</b>

[Example R script](#method)<br></br>
[Example data](#transectmeasure-example)<br></br>
[Example output plot](#output-example)<br></br>
[Folder structure](#introduction)<br></br>
[Bibliography](#bibliography)

<HR>
</HR>

#<a name="method"></a>Example R script

The six sequential example R scripts are provided. These are designed to be run sequentially:

<a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleR_0_HabitatAnnotation_Format.and.write.data_160919.R">0. Format habitat annotation data from BRUV </a>

<a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleR_1_Format%20and%20Check.data_160925.R">1. format and check species names and min and max lengths against a master list.</a>

<a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleR_2_Tidy%20data%20for%20analysis%20including%20CalcBiomass_160925.R">2. tidy data for analysis and  - if you need to - calculate biomass from length-weight relationships.</a>

<a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleR_3_CombineDataProducts%2BHabitat.and.summarise_160824.R">3. Combine data products for modeling and plotting.</a>

<a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleR_4_Format.for.PRIMER.R">4. Format data for PRIMER.</a>

<a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleR_x1_generic.univariate.plotting_160927.R">x1. Generic plotting.</a>



The scripts uses Data Wrangling grammar from the tidyr<sup>2</sup> and dplyr<sup>3</sup> packages and data piplines. These packages shoulod be cited if you use the script.
For more information on the grammar of tidyr and dplyr see the <a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">Data Wrangling cheat sheet</a>. 

<HR>
</HR>

#<a name="transectmeasure-example"></a>Example EventMeasure queries

An example <a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleData_1_MaxN.TXT"> MaxN data</a> and example <a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleData_2_Length%20and%203Dpoints.TXT"> Length+3D point </a> data generated by the EventMeasure software are provided to run with the above script.

Also inculded in is an example <a href="https://github.com/TimLanglois/Stereo-or-mono-video-annotation-workflows/blob/master/x_ExampleData_BRUV_TM_HabitatAnnotation.txt"> Habitat Annotation datasets</a>.

<HR>
</HR>

#<a name="output-example"></a>Example output data and plot

The simple plots of the data expected from the R script is provided below.

![alt text](https://cloud.githubusercontent.com/assets/14978794/18816109/d623e9e6-8374-11e6-81c7-c8ac6fc2241b.png "Example plot of length data")

![alt text](https://cloud.githubusercontent.com/assets/14978794/18816121/1abbc88a-8375-11e6-8b43-b2857cef4bd4.png "Example plot of range data")


<HR>
</HR>

#<a name="introduction"></a>Folder structure

The above script assumes that you have a folder strucutre following this format:

![alt text](https://cloud.githubusercontent.com/assets/14978794/18865062/e2d94c96-84cb-11e6-8e55-c91f759c2880.png "Example folder structure")


<HR>
</HR>

#<a name="bibliography"></a>Bibliography

1. Langlois, T. J., S. J. Newman, M. Cappo, E. S. Harvey, B. M. Rome, C. L. Skepper, and C. B. Wakefield. 2015. Length selectivity of commercial fish traps assessed from in situ comparisons with stereo-video: Is there evidence of sampling bias? Fisheries research 161:145â€“155.
<br></br>
2. Hadley Wickham (2016). tidyr: Easily Tidy Data with `spread()` and `gather()` Functions. R package version 0.4.1.
  https://CRAN.R-project.org/package=tidyr
<br></br>
3. Hadley Wickham and Romain Francois (2015). dplyr: A Grammar of Data Manipulation. R package version 0.4.3.
  https://CRAN.R-project.org/package=dplyr

